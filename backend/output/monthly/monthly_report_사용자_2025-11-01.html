<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>월간 업무 보고서</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 210mm;
            margin: 0 auto;
            background: white;
            padding: 40px;
        }

        .report-title {
            color: #4a90e2;
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            border-bottom: 2px solid #4a90e2;
            padding-bottom: 10px;
        }

        .header-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
        }

        .header-table td {
            padding: 12px 15px;
            border: 1px solid #ddd;
        }

        .header-table .label {
            background-color: #e8f4ff;
            font-weight: bold;
            text-align: center;
            width: 100px;
        }

        .header-table input {
            width: 100%;
            border: none;
            padding: 5px;
            font-size: 14px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            background-color: #e8f4ff;
            padding: 12px 15px;
            font-weight: bold;
            margin-bottom: 0;
            border: 1px solid #dbdbdb;
            border-bottom: none;
        }

        .kpi-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ddd;
        }

        .kpi-table th,
        .kpi-table td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: center;
        }

        .kpi-table th {
            background-color: #e8f4ff;
            font-weight: bold;
        }

        .kpi-table .category-cell {
            background-color: #e8f4ff;
            font-weight: bold;
            width: 120px;
        }

        .kpi-table .sub-label {
            background-color: #f8f9fa;
            font-weight: 500;
            width: 100px;
        }

        .kpi-table .note-cell {
            width: 120px;
        }

        .kpi-table input {
            width: 100%;
            border: none;
            padding: 5px;
            font-size: 14px;
            text-align: center;
        }

        .weekly-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ddd;
        }

        .weekly-table th,
        .weekly-table td {
            border: 1px solid #ddd;
            padding: 12px 15px;
        }

        .weekly-table th {
            background-color: #e8f4ff;
            font-weight: bold;
            text-align: center;
        }

        .weekly-table .category-cell {
            background-color: #e8f4ff;
            font-weight: bold;
            text-align: center;
            width: 120px;
        }

        .weekly-table .week-cell {
            background-color: #f8f9fa;
            font-weight: 500;
            text-align: center;
            width: 80px;
        }

        .weekly-table .note-cell {
            width: 120px;
        }

        .weekly-table textarea {
            width: 100%;
            border: none;
            padding: 5px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 60px;
            line-height: 1.6;
        }

        .weekly-table textarea:focus {
            background-color: #f8f9fa;
        }

        .section-content {
            border: 1px solid #ddd;
            padding: 15px;
            min-height: 100px;
            background-color: white;
        }

        .text-area {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: none;
            resize: vertical;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.8;
        }

        .text-area:focus {
            outline: none;
            background-color: #f8f9fa;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                max-width: 100%;
                padding: 20px;
            }

            .pdf-save-button {
                display: none !important;
            }
        }

        /* PDF 저장 버튼 스타일 */
        .pdf-save-button {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s;
            font-family: 'Malgun Gothic', sans-serif;
        }

        .pdf-save-button:hover {
            background-color: #357abd;
        }

        .pdf-save-button:active {
            background-color: #2a5f8f;
        }
    </style>
    <!-- html2pdf.js 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <!-- PDF 저장 버튼 -->
    <button class="pdf-save-button" id="pdf-save-btn" onclick="saveAsPDF()">PDF로 저장</button>
    
    <div class="container" id="report-container">
        <div class="report-title">월간 업무 보고서</div>

        <table class="header-table">
            <tr>
                <td class="label">월</td>
                <td><input type="month" id="월" value="2025년 11월"></td>
                <td class="label">작성일자</td>
                <td><input type="date" id="작성일자" value="2025-11-30"></td>
                <td class="label">성명</td>
                <td><input type="text" id="성명" value="사용자"></td>
            </tr>
        </table>

        <div class="section">
            <div class="section-title">월간 핵심 지표</div>
            <table class="kpi-table">
                <thead>
                    <tr>
                        <th>분류</th>
                        <th colspan="3">건수</th>
                        <th>비고</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="category-cell">신규 계약 건수</td>
                        <td colspan="3"><input type="text" id="신규_계약_건수" value=""></td>
                        <td class="note-cell"><input type="text" id="신규_계약_비고" value=""></td>
                    </tr>
                    <tr>
                        <td class="category-cell">유지 계약 건수</td>
                        <td colspan="3"><input type="text" id="유지_계약_건수" value=""></td>
                        <td class="note-cell"><input type="text" id="유지_계약_비고" value=""></td>
                    </tr>
                    <tr>
                        <td class="category-cell">상담 진행 건수</td>
                        <td colspan="3"><input type="text" id="상담_진행_건수" value=""></td>
                        <td class="note-cell"><input type="text" id="상담_진행_비고" value=""></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <div class="section-title">주차별 세부 업무</div>
            <table class="weekly-table">
                <thead>
                    <tr>
                        <th>분류</th>
                        <th></th>
                        <th>업무내용</th>
                        <th>비고</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="category-cell" rowspan="5">요일별 세부 업무</td>
                        <td class="week-cell">1주</td>
                        <td><textarea id="week1_content" placeholder="1주차 업무 내용을 입력하세요">상담 자료 정리와 보장안 구성 작업이 지속적으로 이루어졌으며, 리포트 작성이 강조되었습니다.
상담 자료 정리 및 추가 자료 요청이 빈번하게 발생하였습니다.
주간 목표로 연말 대비 상담 증가 및 상담 자료 분석이 설정되었습니다.</textarea></td>
                        <td class="note-cell"><textarea id="week1_note"></textarea></td>
                    </tr>
                    <tr>
                        <td class="week-cell">2주</td>
                        <td><textarea id="week2_content" placeholder="2주차 업무 내용을 입력하세요">고객 상담 자료 정리와 신규 리드 상담이 주요하게 진행되었습니다.
건강보험 점검과 보장안 구성이 지속적으로 수행되었습니다.
신규 리드 상담을 중심으로 상담 기반 보장안 구성이 이루어졌습니다.</textarea></td>
                        <td class="note-cell"><textarea id="week2_note"></textarea></td>
                    </tr>
                    <tr>
                        <td class="week-cell">3주</td>
                        <td><textarea id="week3_content" placeholder="3주차 업무 내용을 입력하세요">연말 대비 상담 다변화와 보장 점검이 강조되었습니다.
신규 리드 상담 및 상담 자료 정리가 지속적으로 진행되었습니다.
고객 보장안 구성과 포트폴리오 리포트 작성이 주요 업무로 수행되었습니다.</textarea></td>
                        <td class="note-cell"><textarea id="week3_note"></textarea></td>
                    </tr>
                    <tr>
                        <td class="week-cell">4주</td>
                        <td><textarea id="week4_content" placeholder="4주차 업무 내용을 입력하세요">건강보험 및 진단비 상담 폭주에 대한 대비가 이루어졌습니다.
신규 리드 상담과 상담 기반 보장안 구성 작업이 지속되었습니다.
보장 점검 리포트 작성 및 상담 자료 정리가 주요하게 이루어졌습니다.</textarea></td>
                        <td class="note-cell"><textarea id="week4_note"></textarea></td>
                    </tr>
                    <tr>
                        <td class="week-cell">5주</td>
                        <td><textarea id="week5_content" placeholder="5주차 업무 내용을 입력하세요"></textarea></td>
                        <td class="note-cell"><textarea id="week5_note"></textarea></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <div class="section-title">익월 계획</div>
            <div class="section-content">
                <textarea class="text-area" id="익월_계획" placeholder="익월 계획을 입력하세요">1. 다음 달에는 주요 고객 상담을 10건 목표로 설정하고, 신규 고객 발굴 자동화 도구를 적용할 예정입니다.
2. 기존 고객 리텐션을 위한 패키지 제공 계획을 수립할 것입니다.
3. 맞춤형 상담 스크립트를 개편하여 상담 효율을 높일 예정입니다.
4. 신규 리드 생성 및 관리 시스템을 강화하여 리드 전환율을 높일 것입니다.
5. 건강보험 및 진단비 문의에 대한 대응 체계를 강화할 계획입니다.</textarea>
            </div>
        </div>
    </div>

    <script>
        function saveAsPDF() {
            const button = document.getElementById('pdf-save-btn');
            const originalText = button.textContent;
            
            // 버튼 비활성화 및 텍스트 변경
            button.disabled = true;
            button.textContent = 'PDF 생성 중...';
            
            // PDF 생성 옵션
            const element = document.getElementById('report-container');
            const opt = {
                margin: [10, 10, 10, 10],
                filename: 'report.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait',
                    compress: true
                }
            };
            
            // PDF 생성
            html2pdf().set(opt).from(element).save().then(() => {
                // 완료 후 버튼 복원
                button.disabled = false;
                button.textContent = originalText;
            }).catch((error) => {
                console.error('PDF 생성 실패:', error);
                alert('PDF 생성 중 오류가 발생했습니다.');
                button.disabled = false;
                button.textContent = originalText;
            });
        }
    </script>
</body>
</html>